# MIF 2.1
# a simple system of uncoupled spins to illustrate the effect of temperature
# The initial state is a system of perfect order and magnetization Mx = Ms, My = Mz = 0
# Under the influence of temperature order decreases rapidly
# My and Mz will fluctuate around zero
# Mx decays exponentially with characteristic time thau = 5.835e-11 s
# and <Mx> = Ms*exp(-t/thau)

#Destination Archiv mmArchive
Destination mmDataTable mmDataTable
Destination mmGraph mmGraph
Destination mmDisp1 mmDisp
Destination mmDisp2 mmDisp

#Schedule DataTable Archiv Step 100
Schedule DataTable mmDataTable Step 1
Schedule DataTable mmGraph Step 1
Schedule Oxs_TimeDriver::Magnetization mmDisp1 Step 1
#Schedule Oxs_TimeDriver::Spin mmDisp2 Step 1


Specify Oxs_BoxAtlas:atlas {
  xrange {0 1E-7}
  yrange {0 1E-7}
  zrange {0 1e-9}
}

Specify Oxs_RectangularMesh:mesh {
  cellsize {1e-9 1e-9 1e-9}
  atlas :atlas
}

Specify Oxs_UZeeman {
  multiplier 79.6
  Hrange { { 15000 0 0 15000 0 0 1 } }
}

proc TempScript { stage } {
  set spec Oxs_UniformScalarField
  set spec Oxs_ScriptScalarField
  lappend spec [subst {
      atlas :atlas
      script {SlidingField 1.0}
   }]
   return $spec
}

proc SlidingField { xcutoff xrel yrel zrel } {
   if {$xrel>$xcutoff} { return 0.0 }
   return 290
}

# Specify at least the temperature and timestep you want to use
Specify YY_LLBEulerEvolve:evolver {
  do_precess 1
  gamma_LL 2.21e5
  alpha_t 0.1
  J { Oxs_UniformScalarField  {value 1.47e-20} }
  atom_moment { Oxs_UniformScalarField {value 3e-23} }
	fixed_timestep 2e-13
	tempscript TempScript
  tempscript_args { stage }
	uniform_seed 111
  ito_calculus 0
}
#gamma_LL 2.21e5

#Specify YY_LLBTimeDriver {
Specify Oxs_TimeDriver {
 basename test01
 vector_field_output_format {binary 4}
 scalar_output_format %.15g
 evolver :evolver
 mesh :mesh
 stopping_time 5e-10
 stage_count 0
 Ms { Oxs_UniformScalarField  {value 500e3} }
 m0 { Oxs_UniformVectorField { norm 1  vector {1 0 0} } }
}

